<!doctype html>
<html lang="zh-CN">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>

  
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />

  
  
  

  <link rel="stylesheet" href="/css/mobi.css-3.1.1/dist/mobi.min.css">
<link rel="stylesheet" href="/css/caomei1.2.1/style.css">
<link rel="stylesheet" href="/css/theme.css">

  
    <meta name="keywords" content="GeoJSON, TopoJSON, JSON" />
  

  
    <link rel="alternate" href="/atom.xml" title="流浪小猫的博客" type="application/atom+xml" />
  

  
    <link rel="shortcut icon" href="/favicon.ico">
  

  <title>GeoJSON 和 TopoJSON - 流浪小猫的博客</title>
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

  <body class="theme-body">
    <div class="flex-center theme-header-wrapper">
  <div class="container flex-left units-gap theme-header-container">
    <a href="/" class="unit-0 theme-header-icon theme-icon-link" title="首页">
      <i class="czs-home-l"></i>
    </a>
    <div class="flex-center text-center flex-middle unit theme-header-title theme-header-title-no-transition">
      流浪小猫的博客
    </div>
    <a class="unit-0 theme-header-icon theme-icon-link theme-header-sidebar-icon" href="javascript:void(0);" title="更多">
      <i class="czs-menu-l"></i>
    </a>
  </div>
</div>
<div class="theme-header-placeholder"></div>

    <div class="flex-center">
      <div class="container">
        <article>
  <h1 class="text-center">
    GeoJSON 和 TopoJSON
  </h1>
  <div class="text-center top-gap">
    <div class="text-small text-muted">
  <time datetime="2015-04-24T00:00:00+08:00">
    2015-04-24
  </time>
  <span class="theme-separator">·</span>
  <i class="czs-user-l"></i>
  <a class="text-muted theme-text-no-decoration" href="https://github.com/xcatliu">xcatliu</a>
  <span class="theme-separator">·</span>
  <i class="czs-bookmark-l"></i>
  <a class="text-muted theme-text-no-decoration" href="/categories/Programmer/">Programmer</a>
  <span class="theme-comment-count-container theme-hide theme-comment-count-container-transparent">
    <span class="theme-separator">·</span>
    <i class="czs-comment-l"></i>
    <a class="text-muted theme-text-no-decoration theme-comment-count" data-disqus-identifier="2015/04/24/geojson_and_topojson/" href="/2015/04/24/geojson_and_topojson/#disqus_thread"></a>
  </span>
</div>

  </div>
  <div class="top-gap-big">
    <blockquote>
<p>GeoJSON 是用来描述一系列几何形状的数据结构。它可以描述以下几种几何类型：Point、LineString、Polygon、MultiPoint、MultiLineString 和 MultiPolygon。</p>
</blockquote>
<blockquote>
<p>TopoJSON 是 GeoJSON 的拓展，用来描述拓扑结构。通过提取图形中公用的点来减少冗余，一般可以把 GeoJSON 的大小压缩到原来的 20%。</p>
</blockquote>
<a id="more"></a>
<h2 id="GeoJSON"><a href="#GeoJSON" class="headerlink" title="GeoJSON"></a>GeoJSON</h2><p>GeoJSON 使用 <code>type</code> 表示数据的类型。</p>
<p>当 <code>type</code> 取值 <code>Point</code>、<code>LineString</code>、<code>Polygon</code>、<code>MultiPoint</code>、<code>MultiLineString</code>、<code>MultiPolygon</code> 或 <code>GeometryCollection</code> 时，用来表示几何图。</p>
<p>当 <code>type</code> 取值 <code>Feature</code> 时，除了几何图外，还可以包含其他自定义信息。</p>
<p>当 <code>type</code> 取值 <code>FeatureCollection</code> 时，可以包含多个 Feature Objects。</p>
<p>GeoJSON 使用一维数组表示 <code>Point</code>，二维数组表示 <code>MultiPoint</code> 或 <code>LineString</code>（或 <code>LinearRing</code> 即环线），三维数组表示 <code>MultiLineString</code> 或 <code>Polygon</code>（包含洞的面），四维数组表示 <code>MultiPolygon</code>。</p>
<p>具体的规则，请直接看 <a href="http://geojson.org/geojson-spec.html" target="_blank" rel="external">GeoJSON 规范</a>（最好阅读完了再继续往下看）。</p>
<h2 id="TopoJSON"><a href="#TopoJSON" class="headerlink" title="TopoJSON"></a>TopoJSON</h2><p>TopoJSON 通过四种方式压缩了 GeoJSON 的大小。</p>
<h3 id="TopoJSON-的压缩算法"><a href="#TopoJSON-的压缩算法" class="headerlink" title="TopoJSON 的压缩算法"></a>TopoJSON 的压缩算法</h3><ol>
<li>把所有点提取到一个数组中，其他需要用到点的地方，都直接填入 index 即可。这样做的话，可以极大的减少数据的冗余，比如两个图形交界的地方只用存一份数据</li>
<li>把浮点数转化为整型数，通过 transform 来转化</li>
<li>点列表除了第一个点以外，其他的点都只存储相对位置</li>
<li>通过 <code>topojson.simplify</code> 压缩（官方没有具体介绍）</li>
</ol>
<p>通过前三种方式，即可使得大小能被压缩到原本的 20%。</p>
<h3 id="TopoJSON-的规范"><a href="#TopoJSON-的规范" class="headerlink" title="TopoJSON 的规范"></a>TopoJSON 的规范</h3><p>具体的规范可以直接阅读 <a href="https://github.com/topojson/topojson-specification/blob/master/README.md" target="_blank" rel="external">TopoJSON 规范</a>。</p>
<h3 id="TopoJSON-API"><a href="#TopoJSON-API" class="headerlink" title="TopoJSON API"></a>TopoJSON API</h3><p>官方只给出了 JavaScript 版本（另外有人实现了 python 版本），下面做个简单介绍。</p>
<h4 id="Client-API"><a href="#Client-API" class="headerlink" title="Client API"></a>Client API</h4><ul>
<li><code>topojson.feature</code>：从一个 <code>TopoJSON</code> 中获取指定的 <code>Feature</code> 或 <code>FeatureCollection</code></li>
<li><code>topojson.merge</code>：把指定的面融合成一个面</li>
<li><code>topojson.mergeArcs</code>：和 <code>topojson.merge</code> 一样，不过返回一个 <code>TopoJSON MultiPolygon</code> 而不是 <code>GeoJSON</code></li>
<li><code>topojson.mesh</code>：输入多个面，输出多条线，若两个面共用一条线，则只输出一次，用于防止边界被重复渲染</li>
<li><code>topojson.meshArcs</code>：和 <code>topojson.mesh</code> 一样，不过返回一个 <code>TopoJSON MultiLineString</code> 而不是 <code>GeoJSON</code></li>
<li><code>topojson.neighbors</code>：对每个面找到与其相邻的面，可以用于四色问题</li>
<li><code>topojson.presimplify</code>：没有官方文档</li>
</ul>
<h4 id="Server-API"><a href="#Server-API" class="headerlink" title="Server API"></a>Server API</h4><ul>
<li><code>topojson.topology</code>：把 <code>GeoJSON</code> 转换成 <code>TopoJSON</code></li>
<li><code>topojson.simplify</code>：没有官方介绍</li>
<li><code>topojson.prune</code>：去掉没有用上的点</li>
<li><code>topojson.filter</code>：没有官方介绍</li>
<li><code>topojson.bind</code>：没有官方介绍</li>
</ul>
<h4 id="Command-Line-Tools"><a href="#Command-Line-Tools" class="headerlink" title="Command Line Tools"></a>Command Line Tools</h4><ul>
<li>可以把 GeoJSON、SHP 或 CSV 转化为 TopoJSON</li>
</ul>
<p>更多请阅读 <a href="https://github.com/mbostock/topojson/wiki/API-Reference" target="_blank" rel="external">TopoJSON API Reference</a> 和 <a href="https://github.com/mbostock/topojson/wiki/Command-Line-Reference" target="_blank" rel="external">Command Line Reference</a>。</p>
<h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><ul>
<li><a href="http://geojson.org/geojson-spec.html" target="_blank" rel="external">GeoJSON 规范</a></li>
<li><a href="https://github.com/topojson/topojson-specification/blob/master/README.md" target="_blank" rel="external">TopoJSON 规范</a></li>
<li><a href="https://github.com/mbostock/topojson/wiki/API-Reference" target="_blank" rel="external">TopoJSON API Reference</a></li>
<li><a href="https://github.com/mbostock/topojson/wiki/Command-Line-Reference" target="_blank" rel="external">Command Line Reference</a></li>
</ul>

  </div>
</article>
<blockquote class="top-gap-big"> <p> 本文遵循 <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" class"text-muted">CC BY-ND-ND 3.0</a> 协议，转载请注明原作者，禁止商用，禁止演绎。 </p> </blockquote>
<div class="top-gap-big text-center text-muted">
  <small>
    <i class="czs-tag-l"></i>
    <a class="text-muted" href="/tags/GeoJSON/">GeoJSON</a> , <a class="text-muted" href="/tags/TopoJSON/">TopoJSON</a> , <a class="text-muted" href="/tags/JSON/">JSON</a>
  </small>
</div>


  <div id="disqus_thread" class="top-gap-big"></div>
  <script>
    var langMap = {
      en: 'en',
      'zh-CN': 'zh'
    };
    var disqus_config = function () {
      this.language = langMap['zh-CN'] || langMap['en'];
      this.page.url = 'http://blog.xcatliu.com/2015/04/24/geojson_and_topojson/';
      this.page.identifier = '2015/04/24/geojson_and_topojson/';
      this.page.title = 'GeoJSON 和 TopoJSON';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = '//xcatliu.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        <hr class="top-gap-big"></hr>
<p class="text-center">
  <small class="text-muted">
    &copy;
    
      2012 -
    
    <span itemprop="copyrightYear">2020</span>
    <i class="czs-heart" style="color:red;"></i>
    <span itemprop="copyrightHolder">xcatliu</span>

    <br/>

    由 <a class="text-muted" href="https://hexo.io" title="Hexo">Hexo</a> 强力驱动
    <span class="theme-separator">·</span>
    主题
    <a class="text-muted" href="https://github.com/xcatliu/hexo-theme-milk">Milk</a>
  </small>
</p>

      </div>
      <div class="theme-sidebar-mask theme-hide"></div>
<aside class="theme-sidebar-wrapper">
  <div class="container flex-left units-gap theme-header-container">
    
    <a class="unit-0 theme-icon-link" href="/archives" title="归档">
      <i class="czs-folder-l"></i>
    </a>
  
    <a class="unit-0 theme-icon-link" href="/categories" title="分类">
      <i class="czs-bookmark-l"></i>
    </a>
  
    <a class="unit-0 theme-icon-link" href="/tags" title="标签">
      <i class="czs-tag-l"></i>
    </a>
  
    <div class="unit"></div>
  
    <a class="unit-0 theme-icon-link" href="http://xcatliu.com" title="关于我">
      <i class="czs-user-l"></i>
    </a>
  

  </div>
  <div class="container">
    
          <h2>流浪小猫的博客</h2>
          
          <p class="top-gap-0 text-muted">记录我的成长点滴</p>
          
          <div class="flex-left flex-middle top-gap">
            <img alt="Avatar" height="24" src="/assets/about/xcatliu_512.png"/>
            <span class="theme-sidebar-author">xcatliu</span>
          </div>
          
          <p>欢迎访问流浪小猫的博客，这里搜集了我的技术文章和生活感悟，希望能够与您一起交流，共同成长。</p>
          
          <p class="theme-sidebar-social">
            
    <a class="unit-0 theme-icon-link" href="https://github.com/xcatliu" title="GitHub">
      <i class="czs-github"></i>
    </a>
  
    <a class="unit-0 theme-icon-link" href="https://www.v2ex.com/member/xcatliu" title="V2EX">
      <i class="czs-v2ex"></i>
    </a>
  
    <a class="unit-0 theme-icon-link" href="https://twitter.com/xcatliu" title="Twitter">
      <i class="czs-twitter"></i>
    </a>
  
    <a class="unit-0 theme-icon-link" href="mailto:xcatliu@gmail.com" title="Gmail">
      <i class="czs-message-l"></i>
    </a>
  
    <a class="unit-0 theme-icon-link" href="/atom.xml" title="RSS 订阅">
      <i class="czs-rss"></i>
    </a>
  

          </p>
          
          <h5>友情链接</h5>
          <p class="text-muted">
            <small>
              <ul class="theme-list-style-none">
                <li><a class="text-muted" href="http://chuangzaoshi.com/">创造狮</a></li><li><a class="text-muted" href="https://blog.jamespan.me/">James Pan's Blog</a></li><li><a class="text-muted" href="/links">More</a></li>
              </ul>
            </small>
          </p>
          
  </div>
</aside>

    </div>
    <script src="/js/theme.js"></script>
    
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-45256157-6', 'auto');
    ga('send', 'pageview');
  </script>


    
  <script id="dsq-count-scr" src="//xcatliu.disqus.com/count.js" async></script>

  </body>
</html>
